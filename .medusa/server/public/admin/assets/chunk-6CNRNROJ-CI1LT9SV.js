import{r as c,ci as x,cj as g,ck as q,k as v}from"./index-C9AxsCP1.js";var E=()=>{const[n,r]=c.useState(""),[s,t]=c.useState(""),a=c.useCallback(x(o=>t(o),300),[]);return c.useEffect(()=>(a(n),()=>a.cancel()),[n,a]),{searchValue:n,onSearchValueChange:r,query:s||void 0}},k=({queryKey:n,queryFn:r,getOptions:s,defaultValue:t,defaultValueKey:a,pageSize:o=10})=>{const{searchValue:u,onSearchValueChange:b,query:f}=E(),p=a||"id",{data:h}=g({queryKey:n,queryFn:async()=>r({[p]:t,limit:Array.isArray(t)?t.length:1}),enabled:!!t}),{data:d,...l}=q({queryKey:[...n,f],queryFn:async({pageParam:e=0})=>await r({q:f,limit:o,offset:e}),initialPageParam:0,getNextPageParam:e=>e.count>e.offset+e.limit?e.offset+e.limit:void 0,placeholderData:v}),i=(d==null?void 0:d.pages.flatMap(e=>s(e)))??[],m=h?s(h):[],D=!l.isPending&&!i.length&&!u;return t&&m.length&&!u&&m.forEach(e=>{i.find(y=>y.value===e.value)||i.unshift(e)}),{options:i,searchValue:u,onSearchValueChange:b,disabled:D,...l}};export{E as a,k as u};
